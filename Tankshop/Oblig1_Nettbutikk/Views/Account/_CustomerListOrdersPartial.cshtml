@model List<Oblig1_Nettbutikk.Models.OrderView>

<h1>Ordrehistorikk</h1>
<ul>
    @{
        if (Model.Count == 0)
        {
            <li>
                <span style="color:deeppink">Ingen ordre foretatt</span>
            </li>

        }
    }
    @foreach (var order in Model)
    {
        <li class="liOrderItem">
            <a><time>@order.Date</time></a> OrdreId: @order.OrderId

            <table >
                <tr><th>Produkt</th><th>Antall</th><th>Enhetspris</th><th>Totalpris</th></tr>
                @foreach (var item in order.Orderlines)
                {
                    var productTotal = item.Product.Price * item.Count;
                    <tr>


                        <td>@Html.ActionLink(@item.Product.Name, "Product", "Product", new { ProductId = item.Product.ProductID, ReturnUrl=Request.RawUrl }, null)</td>
                        <td>@item.Count</td>
                        <td>@String.Format("{0:n}", item.Product.Price) kr</td>
                        <td>@String.Format("{0:n}", productTotal) kr</td>

                        </tr>
                }
            </table>

        </li>
    }
</ul>

<script>
    $(document).ready(function () {
        $(".liOrderItem table").each(function () {
            $(this).hide();
        })
        $(".liOrderItem").unbind("click");
        $(".liOrderItem").click(function () {
            var listElem = $(this).find("table  ");
            if (listElem.is(":visible")) {
                listElem.hide();
                return;
            }
            else {
                listElem.show();
                return;
            }

        })
    })
</script>
